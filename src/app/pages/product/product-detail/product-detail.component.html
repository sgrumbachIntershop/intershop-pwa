<ish-product-detail-actions></ish-product-detail-actions>

<div *ngIf="product$ | async as product" class="row product-details">
  <div class="col-12 col-md-6 col-lg-8"><ish-product-images [product]="product"></ish-product-images></div>

  <div class="col-12 col-md-6 col-lg-4">
    <ish-product-rating *ishFeature="'rating'" [product]="product"></ish-product-rating>
    <h1>
      <span itemprop="name">{{ product.name }}</span>
    </h1>

    <div class="product-info">
      <div *ngIf="product.manufacturer" class="product-brand">
        <a [routerLink]="['/search', product.manufacturer]">
          <span itemprop="brand">{{ product.manufacturer }}</span>
        </a>
      </div>

      <ish-product-id [product]="product"></ish-product-id>

      <ng-container *ishFeature="'tacton'; else standardInformation">
        <ng-container *ishIsTactonProduct="product; else standardInformation"></ng-container>
      </ng-container>

      <ng-template #standardInformation>
        <ish-product-promotion [product]="product"></ish-product-promotion>

        <div class="price-container" itemprop="offers" itemscope itemtype="http://schema.org/Offer">
          <ish-product-price
            [product]="price || product"
            [showInformationalPrice]="true"
            [showPriceSavings]="true"
          ></ish-product-price>

          <ish-product-inventory
            *ngIf="!isRetailSet(product) && !isMasterProduct(product)"
            [product]="product"
          ></ish-product-inventory>
        </div>

        <ish-product-shipment
          *ngIf="!isRetailSet(product) && !isMasterProduct(product)"
          [product]="product"
        ></ish-product-shipment>
      </ng-template>

      <div *ngIf="isVariationProduct(product)" class="product-variation-container">
        <ng-container *ishFeature="'advancedVariationHandling'; else variationSelect">
          <ish-product-variation-display [product]="product"></ish-product-variation-display>
          <a [routerLink]="['/product', product.productMasterSKU]" class="product-variation all-variations-link">{{
            'product.choose_another_variation.link' | translate
          }}</a>
        </ng-container>
        <ng-template #variationSelect>
          <ish-product-variation-select></ish-product-variation-select>
        </ng-template>
      </div>

      <ng-container *ishFeature="'tacton'; else standardInteractions">
        <ish-lazy-tacton-configure-product
          *ishIsTactonProduct="product; else standardInteractions"
          [product]="product"
        ></ish-lazy-tacton-configure-product>
      </ng-container>

      <ng-template #standardInteractions>
        <ng-container *ngIf="!isMasterProduct(product) && product.inStock && product.availability">
          <div *ngIf="!isRetailSet(product)" class="row form-group has-feedback">
            <label for="product-detail-quantity" class="col-form-label label-quantity col-6">{{
              'product.quantity.label' | translate
            }}</label>
            <div class="col-6">
              <ish-product-quantity type="input" id="product-detail-quantity"></ish-product-quantity>
            </div>
          </div>

          <ish-product-add-to-basket
            [class]="'btn-lg btn-block'"
            [translationKey]="isRetailSet(product) ? 'product.add_to_cart.retailset.link' : 'product.add_to_cart.link'"
          ></ish-product-add-to-basket>

          <ish-lazy-product-add-to-order-template
            [class]="'btn btn-default btn-block'"
          ></ish-lazy-product-add-to-order-template>

          <ish-lazy-product-add-to-quote [class]="'btn-block'"></ish-lazy-product-add-to-quote>
        </ng-container>
      </ng-template>
    </div>

    <ish-accordion>
      <ish-accordion-item [heading]="'product.description.heading' | translate">
        <div [innerHTML]="product.longDescription"></div>
      </ish-accordion-item>
      <ish-accordion-item
        *ngIf="product.attributes && product.attributes.length"
        [heading]="'product.details.heading' | translate"
      >
        <ish-product-attributes [product]="product"></ish-product-attributes>
      </ish-accordion-item>

      <ng-container *ishFeature="'tacton'; else shippingInformation">
        <ng-container *ishIsTactonProduct="product; else shippingInformation"></ng-container>
      </ng-container>

      <ng-template #shippingInformation>
        <ish-accordion-item
          *ngIf="!isMasterProduct(product)"
          [heading]="'product.shipping.heading' | translate"
          dataTestingId="section-shipping-tab"
        >
          <ish-product-shipment [product]="product"></ish-product-shipment>
        </ish-accordion-item>
      </ng-template>
    </ish-accordion>
  </div>
</div>
